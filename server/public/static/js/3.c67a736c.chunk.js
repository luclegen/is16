(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[3],{75:function(e,t,a){"use strict";function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}a.d(t,"a",(function(){return n}))},76:function(e,t,a){"use strict";var n=a(7),s=a(14),i="".concat(window.location.origin+"/api","/users/");t.a=new function e(){Object(n.a)(this,e),this.create=function(e){return s.a.post(i,e)},this.read=function(e){return s.a.get("".concat(i).concat(e))},this.update=function(e){return s.a.put("".concat(i).concat(e.id),e)},this.list=function(e){return s.a.get("".concat(i,"?name=").concat(e))}}},79:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return R}));var n=a(7),s=a(12),i=a(11),r=a(1),o=a(20),c=a.n(o),l=a(22),d=a(75),u=a(8),m=Object.freeze({FEMALE:"Female",MALE:"Male",OTHER:"Other"}),h=a(15),v=a(14),p="".concat(window.location.origin+"/api","/codes/"),b=new function e(){Object(n.a)(this,e),this.create=function(e){return v.a.post(p,e)}},j=a(76),g=a(3),f={name:"",surname:"",email:"",password:"",confirm:"",day:(new Date).getDate(),month:(new Date).getMonth()+1,year:(new Date).getFullYear(),sex:"",code:"",available:!0,sent:!1,submitted:!1},x=function(e){Object(s.a)(a,e);var t=Object(i.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).setValue=function(e){return s.setState(Object(d.a)({},e.target.name,e.target.value))},s.setInt=function(e){return s.setState(Object(d.a)({},e.target.name,parseInt(e.target.value)))},s.isCode=function(){return 6==="0".repeat(6).split("").map((function(e,t){return document.querySelectorAll(".input-digit")[t].value})).filter((function(e){return u.a.isDigit(e)})).length},s.setCode=function(){return s.setState({code:s.isCode()?Array.from(document.querySelectorAll(".input-digit")).map((function(e){return e.value})).join(""):""})},s.getInput=function(){return document.querySelectorAll(".input-digit")},s.getIndex=function(e){return Array.from(document.querySelector(".row-code").children).findIndex((function(t){return t===e}))},s.checkSex=function(e){var t=e.target.className.split(" ")[0];if("form-check-female"===t||"form-check-male"===t||"form-check-other"===t){var a=Array.from(e.target.children)[1];a.checked=!0,s.setState({sex:a.value})}},s.enterName=function(e){return e.target.setCustomValidity(e.target.value?u.a.isName(e.target.value)?"":"Invalid first name.":"This field is required.")},s.enterSurname=function(e){return e.target.setCustomValidity(e.target.value?u.a.isSurname(e.target.value)?"":"Invalid last name.":"This field is required.")},s.enterEmail=function(){var e=Object(l.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.available(t.target.value);case 2:e.t0=e.sent.status,a=200===e.t0,s.setState({available:a}),t.target.setCustomValidity(t.target.value?u.a.isEmail(t.target.value)?a?"":"Email is duplicate!":"Invalid email!":"This field is required.");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.enterPassword=function(e){var t=u.a.checkPassword(e.target.value);e.target.setCustomValidity(e.target.value?t.isStrong?"":"Please choose a stronger password. Try a mix of letters, numbers, and symbols (minimum is 8 characters)!":"This field is required."),document.querySelector("meter").value=t.level,s.setState({strength:t.strength})},s.enterConfirm=function(e){return e.target.setCustomValidity(e.target.value?e.target.value===s.state.password?"":"The passwords do not match.":"This field is required.")},s.enterDigit=function(e){var t=[s.getIndex(e.target.closest(".col-md")),s.getInput()],a=t[0],n=t[1];if(e.target.value.length>1)return n[a].value=e.target.value[0];a<5&&u.a.isDigit(n[a].value)&&1===n[a].value.length&&n[a+1].focus(),s.setCode()},s.clearDigit=function(e){var t=[s.getIndex(e.target.closest(".col-md")),s.getInput()],a=t[0],n=t[1];8===e.keyCode&&a>0&&""===e.target.value&&n[a-1].select(),s.isCode()||s.setState({code:Array.from(document.querySelectorAll(".input-digit")).map((function(e){return e.value})).join("")}),s.setCode()},s.pasteDigit=function(e){var t=[s.getIndex(e.target.closest(".col-md")),s.getInput()],a=t[0],n=t[1],i=(e.clipboardData||window.clipboardData).getData("text"),r=i.length>6-a?6-a:i.length,o=r+a>5?5:r+a;setTimeout((function(){n[a].value=u.a.isDigit(i[0])?i[0]:null,u.a.isDigits(i)&&n[o].focus()}));for(var c=a,l=0;l<r;c++,l++)n[c].value=u.a.isDigit(i[l])?i[l]:null;s.setCode()},s.chooseDob=function(e){document.querySelector("#dayRegister").setCustomValidity(u.a.isDate("yearRegister"===e.target.id?e.target.value:s.state.year,"monthRegister"===e.target.id?e.target.value:s.state.month,"dayRegister"===e.target.id?e.target.value:s.state.day)?"":"Invalid date of birth."),document.querySelector("#yearRegister").setCustomValidity((new Date).getFullYear()-parseInt("yearRegister"===e.target.id?e.target.value:s.state.year)>=5?"":"You must be 5 years or older")},s.chooseSex=function(){return document.querySelector("#femaleRegister").setCustomValidity(s.state.sex?"":"Please select one of these options.")},s.getIsValidDob=function(){return(s.state.submitted||s.state.day!==(new Date).getDate()||s.state.month!==(new Date).getMonth()+1||s.state.year!==(new Date).getFullYear())&&(u.a.isDate(s.state.year,s.state.month,s.state.day)&&u.a.isOldEnough(s.state.year)?"is-valid":"is-invalid")},s.send=function(){return u.a.isEmail(s.state.email)&&b.create({email:s.state.email}).then((function(e){return window.open(e.data)&&s.setState({sent:!0})}))},s.submit=function(e){e.preventDefault(),s.setState({submitted:!0}),s.state.password===s.state.confirm&&s.state.name&&s.state.surname&&s.state.email&&s.state.password&&s.state.confirm&&s.state.day&&s.state.month&&s.state.year&&s.state.code&&(document.querySelector("#femaleRegister").setCustomValidity(s.state.sex?"":"Please select one of these options."),document.querySelector("#yearRegister").setCustomValidity(u.a.isOldEnough(s.state.year)?"":"You must be 5 years or older!"),j.a.create(s.state).then((function(e){alert(e.data),document.querySelector(".form-register").reset(),document.querySelector("meter").value=0,s.setState(f)})).catch((function(e){var t;return 410===(null===(t=e.response)||void 0===t?void 0:t.status)&&Array.from(document.querySelectorAll(".input-digit")).map((function(e){return e.value=""}))})))},s.componentDidUpdate=function(){return window.onbeforeunload=function(){return!!(s.state.name||s.state.surname||s.state.email||s.state.password||s.state.day||s.state.month||s.state.year||s.state.sex||s.state.code)||void 0}},s.render=function(){return Object(g.jsx)("section",{className:"section-register",children:Object(g.jsxs)("form",{className:"form-register",onSubmit:s.submit,children:[Object(g.jsx)("div",{className:"row",children:Object(g.jsx)("div",{className:"col-dm d-flex justify-content-end",children:Object(g.jsx)("button",{className:"btn-close",type:"reset",onClick:s.props.close})})}),Object(g.jsx)("h1",{className:"h1-register",children:"Sign Up"}),Object(g.jsxs)("div",{className:"row-name",children:[Object(g.jsx)("div",{className:"col-md",children:Object(g.jsxs)("div",{className:"form-floating-name",children:[Object(g.jsx)("input",{className:"form-control ".concat(s.state.name&&(u.a.isName(s.state.name)?"is-valid":"is-invalid")),id:"nameRegister",name:"name",type:"text",placeholder:"Name",value:s.state.name,pattern:u.a.namePattern,onInput:s.enterName,onInvalid:s.enterName,onChange:s.setValue,required:!0}),Object(g.jsx)("label",{htmlFor:"nameRegister",children:"Name"})]})}),Object(g.jsx)("div",{className:"col-md",children:Object(g.jsxs)("div",{className:"form-floating-surname",children:[Object(g.jsx)("input",{className:"form-control ".concat(s.state.surname&&(u.a.isSurname(s.state.surname)?"is-valid":"is-invalid")),id:"surnameRegister",name:"surname",type:"text",placeholder:"Surname",pattern:u.a.surnamePattern,onInput:s.enterSurname,onInvalid:s.enterSurname,onChange:s.setValue,required:!0}),Object(g.jsx)("label",{htmlFor:"surnameRegister",children:"Surname"})]})})]}),Object(g.jsx)("div",{className:"row-email",children:Object(g.jsx)("div",{className:"col-md",children:Object(g.jsxs)("div",{className:"form-floating-email",children:[Object(g.jsx)("input",{className:"form-control ".concat(s.state.email&&(u.a.isEmail(s.state.email)&&s.state.available?"is-valid":"is-invalid")),id:"addressRegister",name:"email",type:"email",placeholder:"Email",pattern:u.a.emailPattern,onInput:s.enterEmail,onInvalid:s.enterEmail,onChange:s.setValue,required:!0}),Object(g.jsx)("label",{htmlFor:"addressRegister",children:"Email"})]})})}),Object(g.jsxs)("div",{className:"row-password",children:[Object(g.jsx)("div",{className:"col-md",children:Object(g.jsxs)("div",{className:"form-floating-password",children:[Object(g.jsx)("input",{className:"form-control ".concat(s.state.password&&(u.a.checkPassword(s.state.password).isStrong?"is-valid":"is-invalid")),id:"passwordRegister",name:"password",type:"password",placeholder:"Password",minLength:"8",onInput:s.enterPassword,onChange:s.setValue,required:!0}),Object(g.jsx)("label",{htmlFor:"passwordRegister",children:"Password"})]})}),Object(g.jsx)("div",{className:"col-md",children:Object(g.jsxs)("div",{className:"form-floating-confirm",children:[Object(g.jsx)("input",{className:"form-control ".concat(s.state.confirm&&(s.state.confirm===s.state.password?"is-valid":"is-invalid")),id:"confirmRegister",name:"confirm",type:"password",placeholder:"Confirm",onInput:s.enterConfirm,onInvalid:s.enterConfirm,onChange:s.setValue,required:!0}),Object(g.jsx)("label",{htmlFor:"confirmRegister",children:"Confirm"})]})})]}),Object(g.jsx)("meter",{id:"passwordStrengthRegister",title:"Use 8 or more characters with a mix of letters, numbers, and symbols",max:"4",value:"0"}),Object(g.jsx)("div",{className:"input-group-password-strength",children:s.state.strength&&Object(g.jsx)("label",{className:"password-strength",htmlFor:"passwordStrengthRegister",children:u.a.checkPassword(s.state.password).strength})}),Object(g.jsx)("label",{className:"label-group ".concat(s.getIsValidDob()),htmlFor:"dobRegister",children:"Date of birth"}),Object(g.jsxs)("div",{className:"row-dob",id:"dobRegister",children:[Object(g.jsx)("div",{className:"col-md",children:Object(g.jsxs)("div",{className:"form-floating-day",children:[Object(g.jsx)("select",{className:"form-select-day ".concat(s.getIsValidDob()),id:"dayRegister",name:"day",placeholder:"Day",value:s.state.day,onInput:s.chooseDob,onChange:s.setInt,required:!0,children:"0".repeat(31).split("").map((function(e,t){return Object(g.jsx)("option",{value:t+1,children:t+1},t)}))}),Object(g.jsx)("label",{htmlFor:"dayRegister",children:"Day"})]})}),Object(g.jsx)("div",{className:"col-md",children:Object(g.jsxs)("div",{className:"form-floating-month",children:[Object(g.jsx)("select",{className:"form-select-month ".concat(s.getIsValidDob()),id:"monthRegister",name:"month",placeholder:"Month",value:s.state.month,onInput:s.chooseDob,onChange:s.setInt,required:!0,children:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((function(e,t){return Object(g.jsx)("option",{value:t+1,children:e},t)}))}),Object(g.jsx)("label",{htmlFor:"monthRegister",children:"Month"})]})}),Object(g.jsx)("div",{className:"col-md",children:Object(g.jsxs)("div",{className:"form-floating-year",children:[Object(g.jsx)("select",{className:"form-select-year ".concat(s.getIsValidDob()),id:"yearRegister",name:"year",placeholder:"Year",value:s.state.year,"aria-describedby":"validationDob",onInput:s.chooseDob,onChange:s.setInt,required:!0,children:"0".repeat(200).split("").map((function(e,t){return Object(g.jsx)("option",{value:(new Date).getFullYear()-t,children:(new Date).getFullYear()-t},t)}))}),Object(g.jsx)("label",{htmlFor:"yearRegister",children:"Year"})]})})]}),Object(g.jsx)("label",{className:"label-group ".concat(s.state.sex?"is-valid":s.state.submitted&&!s.state.sex&&"is-invalid"),htmlFor:"genderRegister",children:"Gender"}),Object(g.jsxs)("div",{className:"row-gender",id:"genderRegister",children:[Object(g.jsx)("div",{className:"col-md",children:Object(g.jsxs)("div",{className:"form-check-female ".concat(s.state.sex?"is-valid":s.state.submitted&&!s.state.sex&&"is-invalid"),onClick:s.checkSex,children:[Object(g.jsx)("label",{className:"label-female",htmlFor:"femaleRegister",children:"Female"}),Object(g.jsx)("input",{className:"input-female",id:"femaleRegister",type:"radio",name:"sex",value:m.FEMALE,checked:s.state.sex===m.FEMALE,onInput:s.chooseSex,onChange:s.setValue})]})}),Object(g.jsx)("div",{className:"col-md",children:Object(g.jsxs)("div",{className:"form-check-male ".concat(s.state.sex?"is-valid":s.state.submitted&&!s.state.sex&&"is-invalid"),onClick:s.checkSex,children:[Object(g.jsx)("label",{className:"label-male",htmlFor:"maleRegister",children:"Male"}),Object(g.jsx)("input",{className:"input-male",id:"maleRegister",type:"radio",name:"sex",value:m.MALE,checked:s.state.sex===m.MALE,onInput:s.chooseSex,onChange:s.setValue})]})}),Object(g.jsx)("div",{className:"col-md",children:Object(g.jsxs)("div",{className:"form-check-other ".concat(s.state.sex?"is-valid":s.state.submitted&&!s.state.sex&&"is-invalid"),onClick:s.checkSex,children:[Object(g.jsx)("label",{className:"label-other",htmlFor:"otherRegister",children:"Other"}),Object(g.jsx)("input",{className:"input-other",id:"otherRegister",type:"radio",name:"sex",value:m.OTHER,checked:s.state.sex===m.OTHER,onInput:s.chooseSex,onChange:s.setValue})]})})]}),Object(g.jsx)("label",{className:"label-group",htmlFor:"genderRegister",children:"Code"}),Object(g.jsx)("div",{className:"row-code",id:"codeRegister",children:"0".repeat(6).split("").map((function(e,t){return Object(g.jsx)("div",{className:"col-md",children:Object(g.jsx)("input",{className:"input-digit",type:"number",maxLength:"1",onClick:function(e){return e.target.select()},onInput:s.enterDigit,onDrop:s.enterDigit,onKeyUp:s.clearDigit,onKeyDown:s.clearDigit,onPaste:s.pasteDigit,required:!0})},t)}))}),Object(g.jsx)("div",{className:"row",children:Object(g.jsx)("div",{className:"col-dm d-flex justify-content-center",children:s.state.code?Object(g.jsx)("button",{className:"btn-sign-up",type:"submit",children:"Sign Up"}):Object(g.jsxs)("button",{className:"btn-get-code",type:"button",onClick:s.send,children:[s.state.sent?"Resend":"Send"," Code"]})})})]})})},s.state=f,s}return a}(r.Component),O={email:"",password:"",remembered:!1,available:!1,visible:!1,opened:!1},y=function(e){Object(s.a)(a,e);var t=Object(i.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).setValue=function(e){return s.setState(Object(d.a)({},e.target.name,e.target.value))},s.enterEmail=function(){var e=Object(l.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.target.value){e.next=8;break}return e.next=3,h.a.available(t.target.value);case 3:e.t0=e.sent.status,a=200===e.t0,t.target.setCustomValidity(u.a.isEmail(t.target.value)?a?"Email not registered!":"":"Invalid email!"),s.setState({available:a,visible:!1,password:""}),setTimeout((function(){document.querySelector(".input-group-password")&&(document.querySelector(".input-group-password").style.height=0),document.querySelector(".input-email").style.width="260px"}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.open=function(){return s.setState({opened:!0})},s.close=function(){return s.setState({opened:!1})},s.submit=function(e){e.preventDefault(),s.state.email&&(s.setState({visible:!0}),setTimeout(Object(l.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.querySelector(".input-group-password").style.height="39px",document.querySelector(".input-email").style.width="315px",document.querySelector(".input-password").focus(),s.state.password&&h.a.login(s.state).then((function(e){return u.a.setCookie(e.data)&&(s.state=O)&&setTimeout((function(){return window.location.reload()}))}));case 4:case"end":return e.stop()}}),e)})))))},s.componentDidUpdate=function(){return window.onbeforeunload=function(){return!(!s.state.email&&!s.password)||void 0}},s.render=function(){return Object(g.jsxs)("section",{className:"section-only",children:[Object(g.jsxs)("form",{className:"form-only",onSubmit:s.submit,children:[Object(g.jsx)("img",{className:"logo-img",src:"/logo.svg",alt:"IS16 logo"}),Object(g.jsxs)("h1",{className:"h1-only",children:["Sign in to ","IS16"]}),Object(g.jsxs)("div",{className:"input-group-email ".concat(s.state.visible?"rounded-top":"rounded"),children:[Object(g.jsx)("input",{className:"input-email",type:"email",name:"email",placeholder:"Email",value:s.state.email,pattern:u.a.emailPattern,onInput:s.enterEmail,onInvalid:s.enterEmail,onChange:s.setValue,title:"Please fill out this field.",required:!0}),!s.state.visible&&Object(g.jsx)("button",{className:"btn-input",type:"submit",disabled:!s.state.email,hidden:!0,children:Object(g.jsx)("i",{className:"material-icons",children:"input"})})]}),Object(g.jsx)("div",{className:"input-group-container",children:s.state.visible&&s.state.email&&Object(g.jsxs)("div",{className:"input-group-password",children:[Object(g.jsx)("input",{className:"input-password",type:"password",name:"password",placeholder:"Password",value:s.state.password,onChange:s.setValue,required:!0}),Object(g.jsx)("button",{className:"btn-input",type:"submit",disabled:!s.state.password,children:Object(g.jsx)("i",{className:"material-icons",children:"input"})})]})}),Object(g.jsxs)("a",{className:"link-find-account",href:"/find-account",target:"_blank",rel:"noopener noreferrer",children:["Forgotten password? ",Object(g.jsx)("i",{className:"material-icons",children:"launch"})]}),Object(g.jsx)("button",{className:"btn-create-account",type:"button",onClick:s.open,children:"Create New Account"})]}),s.state.opened&&Object(g.jsx)(x,{close:s.close})]})},s.state=O,s}return a}(r.Component),N=a(21);var w=a(18);function S(e){return function(e){if(Array.isArray(e))return Object(N.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(w.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var C=a(10),I=a(23),_="".concat(window.location.origin+"/api","/messages/"),k=new function e(){Object(n.a)(this,e),this.create=function(e){return v.a.post(_,e)},this.delete=function(e){return v.a.delete("".concat(_).concat(e))},this.list=function(e){return v.a.get("".concat(_,"?name=").concat(e))}},D="".concat(window.location.origin+"/api","/chats/"),q=new function e(){Object(n.a)(this,e),this.view=function(e){return v.a.post("".concat(D).concat(e))},this.read=function(e){return v.a.get("".concat(D).concat(e))},this.update=function(e){return v.a.put("".concat(D).concat(null===e||void 0===e?void 0:e.id),e)},this.list=function(){return v.a.get(D)}},$=function(e){Object(s.a)(a,e);var t=Object(i.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).refresh=function(e){return q.list().then((function(t){var a,n;return s.setState({chats:t.data})||q.read(e||(null===(a=s.state.chat)||void 0===a||null===(n=a._id)||void 0===n?void 0:n.$oid)||null).then((function(e){var t,a;return(!s.state.chat||(null===(t=e.data)||void 0===t||null===(a=t._id)||void 0===a?void 0:a.$oid)===u.a.getQuery("id"))&&setTimeout((function(){return s.scroll()}))&&s.setState({chat:e.data})})).catch((function(e){return 404===e.response.status&&(window.location.href="/")}))}))},s.connect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.a.getQuery("id");return u.a.setQuery("id",e)||(s.props.cableApp.cid=s.props.cableApp.cable.subscriptions.create({channel:"ChatChannel",cid:e},{received:function(e){return s.refresh(e.id)}}))},s.componentDidMount=function(){var e,t;return s.refresh(u.a.getQuery("id")||(null===(e=s.state.chat)||void 0===e||null===(t=e._id)||void 0===t?void 0:t.$oid)).then((function(){var e,t;s.setState({new:!s.state.chat}),s.state.chat&&s.connect(u.a.getQuery("id")||(null===(e=s.state.chat)||void 0===e||null===(t=e._id)||void 0===t?void 0:t.$oid)),s.props.cableApp.id=s.props.cableApp.cable.subscriptions.create({channel:"TopChannel",id:"top"},{received:function(){return s.refresh()}}),setTimeout((function(){var e;return null===(e=document.querySelector(".input-".concat(s.state.new?"user":"message")))||void 0===e?void 0:e.focus()}),500)}))},s.componentDidUpdate=function(){return window.onbeforeunload=function(){var e;return!!(s.state.message||s.state.name||(null===(e=s.state.users)||void 0===e?void 0:e.length)||s.state.title||s.state.photo)||void 0}},s.setValue=function(e){return s.setState(Object(d.a)({},e.target.name,e.target.value))},s.setMessages=function(e){return q.read(e).then((function(e){return s.setState({messages:e.data.messages})}))},s.choose=function(e){var t,a,n,i,r,o,c=e.target.closest(".list-group-item");c.style.cursor="wait",(null===(t=e.target.closest("button"))||void 0===t?void 0:t.id)!==u.a.getQuery("id")&&q.view(null===(a=e.target.closest("button"))||void 0===a?void 0:a.id).then((function(){var t;return s.refresh(null===(t=e.target.closest("button"))||void 0===t?void 0:t.id).then((function(){return c.style.cursor="pointer"}))}))&&(s.connect(null===(n=e.target.closest("button"))||void 0===n?void 0:n.id)&&(s.state.name||(null===(i=s.state.users)||void 0===i?void 0:i.length)||s.state.photo||s.state.title)?window.confirm("Discard?\nChanges you made may not be saved.")&&s.refresh(null===(r=e.target.closest("button"))||void 0===r?void 0:r.id)&&(s.reset()||s.setState({new:!1})||setTimeout((function(){var e;return null===(e=document.querySelector(".input-message"))||void 0===e?void 0:e.focus()}),500)):s.refresh(null===(o=e.target.closest("button"))||void 0===o?void 0:o.id).then((function(){return c.style.cursor="pointer"}))&&(s.reset()||s.setState({new:!1})||setTimeout((function(){var e;return null===(e=document.querySelector(".input-message"))||void 0===e?void 0:e.focus()}),500)))||s.connect()},s.create=function(){var e;return s.state.name||(null===(e=s.state.users)||void 0===e?void 0:e.length)||s.state.photo||s.state.title?window.confirm("Discard?\nChanges you made may not be saved.")&&(s.reset()||s.setState({chat:null,new:!0})||setTimeout((function(){var e;return null===(e=document.querySelector(".input-user"))||void 0===e?void 0:e.focus()}),500)):s.reset()||s.setState({chat:null,new:!0})||setTimeout((function(){var e;return null===(e=document.querySelector(".input-user"))||void 0===e?void 0:e.focus()}),500)},s.edit=function(){var e,t;return setTimeout((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.querySelector(".box-title").clientWidth+26+"px";return setTimeout((function(){return document.querySelector(".input-title").style.setProperty("width",e,"important")}))&&s.setState({edit:!s.state.edit})}))&&s.setState({photo:null===(e=s.state.chat)||void 0===e?void 0:e.photo,title:null===(t=s.state.chat)||void 0===t?void 0:t.title})},s.save=function(){var e,t;return s.state.edit&&q.update({id:null===(e=s.state.chat)||void 0===e||null===(t=e._id)||void 0===t?void 0:t.$oid,photo:s.state.photo,title:s.state.title}).then((function(){return s.refresh()&&s.setState({edit:!1,photo:"",title:""})}))},s.enter=function(e){var t;return 8===e.keyCode&&!s.state.prename&&!s.state.name&&(null===(t=s.state.users)||void 0===t?void 0:t.pop())&&s.setState({users:s.state.users})||s.setState({prename:s.state.name})||setTimeout((function(){return j.a.list(e.target.value).then((function(t){return s.setState({name:e.target.value,foundUsers:t.data})}))&&setTimeout((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.querySelector(".list-group-users"),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.querySelector(".input-group-user"),a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.a.getOffset(document.querySelector(".input-user")),n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:u.a.getOffset(document.querySelector(".label-user"));return e&&t&&(e.style.setProperty("display","block","important")||(e.style.top="0px")&&(e.style.left="0px")&&(e.style.top=a.top-n.top+t.offsetHeight+6+"px")&&(e.style.left=a.left-n.left+"px"))}))&&j.a.list(e.target.value).then((function(t){return s.setState({name:e.target.value,foundUsers:t.data})}))}))},s.add=function(e){var t,a;return setTimeout((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.querySelector(".input-user");return(e.value="")||(null===e||void 0===e?void 0:e.focus())}))&&!(null===(t=s.state.users)||void 0===t?void 0:t.find((function(t){return t.id===e.target.id})))&&(null===(a=s.state.users)||void 0===a?void 0:a.push({id:e.target.id,name:e.target.name}))&&s.setState({users:s.state.users,prename:"",name:"",foundUsers:[]})},s.remove=function(e){var t,a;return e.target.closest(".tag")&&(null===(t=s.state.users)||void 0===t?void 0:t.splice(null===(a=s.state.users)||void 0===a?void 0:a.findIndex((function(t){return t.id===e.target.closest(".tag").id})),1))&&s.setState({users:s.state.users})},s.delete=function(e){var t,a;return window.confirm("Do you sure to "+("true"===(null===(t=e.target.closest(".container-message"))||void 0===t?void 0:t.getAttribute("unsent"))?"delete":"unsent")+" the message?")&&k.delete(null===(a=e.target.closest(".container-message"))||void 0===a?void 0:a.id).then((function(){return s.refresh()}))},s.send=function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===(t=e.target)||void 0===t?void 0:t.closest(".list-group-item");return setTimeout((function(){var e;return null===(e=document.querySelector(".input-user"))||void 0===e?void 0:e.focus()}))&&s.setState({users:[{id:null===a||void 0===a?void 0:a.id,name:null===a||void 0===a?void 0:a.getAttribute("name")}],new:!0})},s.make=function(e){var t,a,n,i,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===(t=e.target)||void 0===t?void 0:t.closest(".list-group-item");return window.confirm("Make admin?\n".concat(null===o||void 0===o?void 0:o.getAttribute("name")," can manage in ").concat(null===(a=s.state.chat)||void 0===a?void 0:a.title,"."))&&q.update({id:null===(n=s.state.chat)||void 0===n||null===(i=n._id)||void 0===i?void 0:i.$oid,admins:[].concat(S(null===(r=s.state.chat)||void 0===r?void 0:r.members.filter((function(e){return["Creator","Admin"].includes(e.role)})).map((function(e){var t;return null===(t=e._id)||void 0===t?void 0:t.$oid}))),[null===o||void 0===o?void 0:o.id])}).then((function(){return s.refresh()}))},s.removeAdmin=function(e){var t,a,n,i,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===(t=e.target)||void 0===t?void 0:t.closest(".list-group-item");return window.confirm("Remove as Admin?\n".concat(null===o||void 0===o?void 0:o.getAttribute("name")," cannot manage in ").concat(null===(a=s.state.chat)||void 0===a?void 0:a.title,"."))&&q.update({id:null===(n=s.state.chat)||void 0===n||null===(i=n._id)||void 0===i?void 0:i.$oid,admins:null===(r=s.state.chat)||void 0===r?void 0:r.members.filter((function(e){return["Creator","Admin"].includes(e.role)})).map((function(e){var t;return null===(t=e._id)||void 0===t?void 0:t.$oid})).filter((function(e){return e!==(null===o||void 0===o?void 0:o.id)}))}).then((function(){return s.refresh()}))},s.removeMember=function(e){var t,a,n,i,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===(t=e.target)||void 0===t?void 0:t.closest(".list-group-item");return window.confirm("Remove?\n".concat(null===o||void 0===o?void 0:o.getAttribute("name")," was removed from ").concat(null===(a=s.state.chat)||void 0===a?void 0:a.title,"."))&&q.update({id:null===(n=s.state.chat)||void 0===n||null===(i=n._id)||void 0===i?void 0:i.$oid,users:null===(r=s.state.chat)||void 0===r?void 0:r.members.map((function(e){var t;return null===(t=e._id)||void 0===t?void 0:t.$oid})).filter((function(e){return e!==(null===o||void 0===o?void 0:o.id)}))}).then((function(){var e;return(null===(e=s.state.chat)||void 0===e?void 0:e.members.map((function(e){var t;return null===(t=e._id)||void 0===t?void 0:t.$oid})).filter((function(e){return e!==(null===o||void 0===o?void 0:o.id)})).includes(u.a.getId()))?s.refresh():window.location.href="/"}))},s.addMember=function(){var e,t,a,n,i;return window.confirm("Add?\n".concat(null===(e=s.state.users)||void 0===e?void 0:e.map((function(e){return e.name})).join(", ")," was added to ").concat(null===(t=s.state.chat)||void 0===t?void 0:t.title,"."))&&q.update({id:null===(a=s.state.chat)||void 0===a||null===(n=a._id)||void 0===n?void 0:n.$oid,users:null===(i=s.state.chat)||void 0===i?void 0:i.members.map((function(e){var t;return null===(t=e._id)||void 0===t?void 0:t.$oid})).concat(s.state.users.map((function(e){return e.id})))}).then((function(){return s.refresh()&&s.setState({name:"",users:[]})}))},s.admin=function(){var e;return null===(e=s.state.chat)||void 0===e?void 0:e.members.filter((function(e){return["Creator","Admin"].includes(e.role)})).map((function(e){var t;return null===(t=e._id)||void 0===t?void 0:t.$oid})).includes(u.a.getId())},s.scroll=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.querySelector(".chat-body");return e&&(e.scrollTop=e.scrollHeight)},s.toggle=function(){return s.setState({info:!s.state.info})},s.toggleDropdown=function(e){var t;return s.setState({open:!s.state.open,id:null===(t=e.target.closest(".list-group-item"))||void 0===t?void 0:t.id})},s.reset=function(){return s.setState({message:"",new:!1,edit:!1,photo:"",title:"",name:"",users:[]})},s.submit=function(e){var t,a,n;return e.preventDefault()||s.state.message&&k.create(s.state.new?{users:null===(t=s.state.users)||void 0===t?void 0:t.map((function(e){return e.id})),body:s.state.message}:{id:null===(a=s.state.chat)||void 0===a||null===(n=a._id)||void 0===n?void 0:n.$oid,body:s.state.message}).then((function(t){return s.connect(t.data)&&s.refresh(t.data)&&(s.reset()||e.target.reset())}))},s.render=function(){var e,t,a,n,i,r,o,c,l,d,m,h,v,p,b,j,f,x,O,y,N,w;return Object(g.jsxs)("section",{className:"section-chats",children:[Object(g.jsxs)("div",{className:"col-chats",children:[Object(g.jsxs)("div",{className:"chats-bar",children:[Object(g.jsx)("h2",{className:"h2-chat",children:"Chats"}),Object(g.jsx)("button",{className:"btn-write",type:"button",onClick:s.create,children:Object(g.jsx)("i",{className:"material-icons",children:"create"})})]}),Object(g.jsx)("div",{className:"search-bar",onMouseEnter:s.coloring,onMouseLeave:s.coloring,children:Object(g.jsxs)("form",{className:"form-search",children:[Object(g.jsx)("button",{className:"btn-search",type:s.state.width>800||s.state.opened&&s.state.keyword?"submit":"button",disabled:s.state.width>800&&!s.state.keyword,onClick:s.open,children:Object(g.jsx)("i",{className:"material-icons",children:"search"})}),Object(g.jsx)("input",{className:"input-search",type:"search",placeholder:"Search for anything",onSelect:s.coloring,onBlur:s.coloring,onInput:s.setKeyword})]})}),Object(g.jsx)("div",{className:"list-group",children:(null===(e=s.state.chats)||void 0===e?void 0:e.length)>0&&s.state.chats.map((function(e,t){var a,n,i,r;return Object(g.jsxs)("button",{className:"list-group-item list-group-item-action ".concat((null===(a=e._id)||void 0===a?void 0:a.$oid)===(null===(n=s.state.chat)||void 0===n||null===(i=n._id)||void 0===i?void 0:i.$oid)&&"active"),id:null===(r=e._id)||void 0===r?void 0:r.$oid,type:"button",onClick:s.choose,children:[Object(g.jsx)(I.a,{avatar:e.photo,name:e.title,width:"60px",height:"60px",fontSize:"45px"}),Object(g.jsxs)("div",{className:"user-info",children:[Object(g.jsx)("p",{className:"fs-5",children:e.title}),Object(g.jsx)("p",{className:"".concat(e._vids.map((function(e){return null===e||void 0===e?void 0:e.$oid})).includes(u.a.getCookie("id"))?"text-truncate":"text-primary"),children:e.message})]}),!e._vids.map((function(e){return null===e||void 0===e?void 0:e.$oid})).includes(u.a.getCookie("id"))&&Object(g.jsx)("span",{className:"new-message",children:Object(g.jsx)("i",{className:"material-icons",children:"fiber_manual_record"})})]},t)}))})]}),Object(g.jsxs)("div",{className:"col-chat col-md-".concat(s.state.new||!s.state.info?"9":"6"),children:[s.state.new?Object(g.jsx)("div",{className:"chat-header",children:Object(g.jsxs)("div",{className:"input-group-user",children:[Object(g.jsx)("label",{className:"label-user",htmlFor:"userInput",children:"To: \xa0"}),s.state.name&&Object(g.jsx)("div",{className:"list-group-users",children:s.state.foundUsers.map((function(e,t){var a;return Object(g.jsx)("button",{type:"button",className:"list-group-item list-group-item-action",id:null===(a=e._id)||void 0===a?void 0:a.$oid,name:e.name,onClick:s.add,children:e.name},t)}))}),null===(t=s.state.users)||void 0===t?void 0:t.map((function(e,t){return Object(g.jsxs)("span",{type:"button",className:"tag",id:e.id,children:[e.name,Object(g.jsx)("button",{className:"btn-tag-close",type:"button",onClick:s.remove,children:Object(g.jsx)("i",{className:"material-icons",children:"close"})})]},t)})),Object(g.jsx)("input",{type:"text",className:"input-user",id:"userInput",name:"name",onInput:s.enter,onKeyUp:s.enter,onChange:s.setValue})]})}):Object(g.jsxs)("div",{className:"chat-header",children:[s.state.chat&&Object(g.jsx)(I.a,{avatar:null===(a=s.state.chat)||void 0===a?void 0:a.photo,name:null===(n=s.state.chat)||void 0===n?void 0:n.title,width:"44px",height:"44px",fontSize:"30px"}),s.state.chat&&Object(g.jsx)("strong",{className:"chat-name",children:null===(i=s.state.chat)||void 0===i?void 0:i.title}),s.state.chat&&Object(g.jsx)("button",{className:"btn-chat-info ".concat(s.state.info&&"border-primary"),type:"button",onClick:s.toggle,children:Object(g.jsx)("i",{className:"material-icons",children:"info"})})]}),Object(g.jsx)("div",{className:"chat-body",children:(null===(r=s.state.chat)||void 0===r||null===(o=r.messages)||void 0===o?void 0:o.length)>0&&(null===(c=s.state.chat)||void 0===c?void 0:c.messages.map((function(e,t,a){var n;return Object(g.jsx)("div",{className:"container-message",id:null===(n=e._id)||void 0===n?void 0:n.$oid,unsent:e.unsent.toString(),children:Object(g.jsxs)("div",{className:"row",children:[Object(g.jsxs)("div",{className:"col-".concat(e._uid.$oid!==u.a.getId()?"8":"4"," col-message justify-content-").concat(e._uid.$oid!==u.a.getId()?"start":"end"),children:[e._uid.$oid!==u.a.getId()&&(0===t||a.length>1&&t>0&&a[t]._uid.$oid!==a[t-1]._uid.$oid)?Object(g.jsx)(I.a,{avatar:e.avatar,name:e.name,width:"40px",height:"40px",fontSize:"30px"}):Object(g.jsx)("div",{style:{width:"40px",height:"40px"}}),e._uid.$oid!==u.a.getId()&&Object(g.jsx)("div",{className:"box-receiver-message ".concat(t>0&&a[t]._uid.$oid===a[t-1]._uid.$oid&&"tl"," ").concat(t<a.length-1&&a[t]._uid.$oid===a[t+1]._uid.$oid&&"bl"," ms-2"),children:e.body})]}),Object(g.jsxs)("div",{className:"col-".concat(e._uid.$oid===u.a.getId()?"8":"4"," col-message justify-content-").concat(e._uid.$oid!==u.a.getId()?"start":"end"),children:[e._uid.$oid===u.a.getId()&&Object(g.jsx)("button",{className:"btn-delete",type:"button",onClick:s.delete,children:Object(g.jsx)("i",{className:"material-icons",children:"delete"})}),e._uid.$oid===u.a.getId()&&Object(g.jsx)("div",{className:"box-sender-message ".concat(t>0&&a[t]._uid.$oid===a[t-1]._uid.$oid&&"tr"," ").concat(t<a.length-1&&a[t]._uid.$oid===a[t+1]._uid.$oid&&"br"),children:e.body})]})]})},t)})))}),((null===(l=s.state.users)||void 0===l?void 0:l.length)>0||s.state.chat)&&Object(g.jsx)("div",{className:"chat-footer",children:Object(g.jsx)("form",{className:"form-message",onSubmit:s.submit,children:Object(g.jsxs)("div",{className:"input-group flex-nowrap",children:[Object(g.jsx)("input",{className:"input-message",type:"text",name:"message",placeholder:"Aa",onChange:s.setValue}),Object(g.jsx)("button",{className:"btn-send",type:"submit",disabled:!s.state.message,children:Object(g.jsx)("i",{className:"material-icons",children:"send"})})]})})})]}),Object(g.jsxs)("div",{className:"col-info ".concat(s.state.new||!s.state.info?"d-none":"d-flex"," col-md-").concat(s.state.new||!s.state.info?"0":"3"),children:[Object(g.jsx)(I.a,{avatar:s.state.photo||(null===(d=s.state.chat)||void 0===d?void 0:d.photo),name:null===(m=s.state.chat)||void 0===m?void 0:m.title,width:"80px",height:"80px",fontSize:"60px"}),Object(g.jsxs)("form",{className:"form-only",onSubmit:function(e){return e.preventDefault()||s.state.edit?s.save(e):s.edit(e)},children:[s.state.edit?Object(g.jsx)("input",{className:"input-title",value:s.state.title,type:"text",name:"title",onChange:s.setValue}):Object(g.jsx)("div",{className:"box-title",children:Object(g.jsx)("strong",{children:(null===(h=s.state.chat)||void 0===h?void 0:h.group)?null===(v=s.state.chat)||void 0===v?void 0:v.title:Object(g.jsx)("a",{href:"/"+(null===(p=s.state.chat)||void 0===p||null===(b=p.members)||void 0===b||null===(j=b.find((function(e){var t;return u.a.getId()!==(null===(t=e._id)||void 0===t?void 0:t.$oid)})))||void 0===j||null===(f=j._id)||void 0===f?void 0:f.$oid),target:"_blank",rel:"noopener noreferrer",children:null===(x=s.state.chat)||void 0===x?void 0:x.title})})}),s.state.edit&&Object(g.jsx)("input",{className:"input-photo",value:s.state.photo,type:"color",name:"photo",onChange:s.setValue})]}),s.admin()&&(null===(O=s.state.chat)||void 0===O?void 0:O.group)&&Object(g.jsxs)("details",{className:"details-customize",open:!0,children:[Object(g.jsx)("summary",{children:Object(g.jsx)("strong",{children:"Customize"})}),Object(g.jsx)("div",{className:"list-group",children:Object(g.jsxs)("button",{type:"button",className:"list-group-item list-group-item-action",onClick:s.state.edit?s.save:s.edit,children:[Object(g.jsx)("i",{className:"material-icons",children:"drive_file_rename_outline"}),Object(g.jsx)("p",{className:"list-group-item-name",children:s.state.edit?"Save":"Edit"})]})})]}),(null===(y=s.state.chat)||void 0===y?void 0:y.group)&&Object(g.jsxs)("details",{className:"details-members",open:!0,children:[Object(g.jsx)("summary",{children:Object(g.jsx)("strong",{children:"Members"})}),Object(g.jsxs)("ul",{className:"list-group",children:[null===(N=s.state.chat)||void 0===N?void 0:N.members.map((function(e,t){var a,n,i,r,o,c;return Object(g.jsxs)("li",{className:"list-group-item",id:null===(a=e._id)||void 0===a?void 0:a.$oid,name:e.name,children:[Object(g.jsx)(I.a,{avatar:e.avatar,name:e.name,width:"40px",height:"40px",fontSize:"30px"}),Object(g.jsx)("p",{className:"member-name",children:"".concat(e.name," ").concat(e.role&&"(".concat(e.role,")"))}),Object(g.jsxs)(C.a,{className:"dropdown-more",isOpen:s.state.id===(null===(n=e._id)||void 0===n?void 0:n.$oid)&&s.state.open,toggle:s.toggleDropdown,children:[Object(g.jsx)(C.d,{className:"dropdown-toggle-more",title:"More",children:Object(g.jsx)("i",{className:"material-icons",children:"more_horiz"})}),Object(g.jsxs)(C.c,{className:"dropdown-menu-more",children:[Object(g.jsxs)(C.b,{className:"dropdown-item-normal",children:[Object(g.jsx)("p",{className:"text-profile",onClick:s.send,children:"Message"}),Object(g.jsx)("i",{className:"material-icons",children:"chat"})]}),Object(g.jsxs)(C.b,{className:"dropdown-item-normal",tag:"a",href:"/"+(null===(i=e._id)||void 0===i?void 0:i.$oid),target:"_blank",rel:"noopener noreferrer",children:[Object(g.jsx)("p",{className:"text-help",children:"View profile"}),Object(g.jsx)("i",{className:"material-icons",children:"info"})]}),s.admin()&&"Creator"!==e.role&&Object(g.jsx)(C.b,{divider:!0}),"Creator"!==e.role&&s.admin()&&Object(g.jsxs)(C.b,{className:"dropdown-item-normal",onClick:e.role?s.removeAdmin:s.make,children:[Object(g.jsx)("p",{className:"text-help",children:"".concat(e.role?"Remove as A":"Make a","dmin")}),Object(g.jsx)("i",{className:"material-icons",children:"".concat(e.role?"remove":"add","_moderator")})]}),((null===(r=e._id)||void 0===r?void 0:r.$oid)===u.a.getId()||s.admin()&&"Creator"!==e.role)&&Object(g.jsxs)(C.b,{className:"dropdown-item-danger",onClick:s.removeMember,children:[Object(g.jsx)("p",{className:"text-logout",children:(null===(o=e._id)||void 0===o?void 0:o.$oid)===u.a.getId()?"Leave group":s.admin()&&"Remove"}),Object(g.jsx)("i",{className:"material-icons",children:(null===(c=e._id)||void 0===c?void 0:c.$oid)===u.a.getId()?"logout":s.admin()&&"person_remove"})]})]})]})]},t)})),s.admin()&&Object(g.jsxs)("button",{type:"button",className:"list-group-item list-group-item-action",onClick:s.addMember,disabled:0===s.state.users.length,children:[Object(g.jsx)("i",{className:"add-member material-icons",children:"person_add"}),Object(g.jsx)("p",{className:"list-group-item-name",children:"Add"})]}),s.admin()&&Object(g.jsx)("li",{className:"list-group-item",children:Object(g.jsxs)("div",{className:"input-group-user",children:[Object(g.jsx)("label",{className:"label-user",htmlFor:"userInput",children:"Add: \xa0"}),s.state.name&&Object(g.jsx)("div",{className:"list-group-users",children:s.state.foundUsers.map((function(e,t){var a;return Object(g.jsx)("button",{type:"button",className:"list-group-item list-group-item-action",id:null===(a=e._id)||void 0===a?void 0:a.$oid,name:e.name,onClick:s.add,children:e.name},t)}))}),null===(w=s.state.users)||void 0===w?void 0:w.map((function(e,t){return Object(g.jsxs)("span",{type:"button",className:"tag",id:e.id,children:[e.name,Object(g.jsx)("button",{className:"btn-tag-close",type:"button",onClick:s.remove,children:Object(g.jsx)("i",{className:"material-icons",children:"close"})})]},t)})),Object(g.jsx)("input",{type:"text",className:"input-user",id:"userInput",onInput:s.enter,onKeyUp:s.enter,onChange:s.setName})]})})]})]})]})]})},s.state={users:[],foundUsers:[],chats:[],chat:null,new:!1,edit:!1,info:!0,open:!1,id:"",name:"",prename:"",photo:"",title:"",message:""},s}return a}(r.Component),R=function(e){Object(s.a)(a,e);var t=Object(i.a)(a);function a(){var e;Object(n.a)(this,a);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).render=function(){return Object(g.jsx)("main",{children:u.a.isLogin()?Object(g.jsx)($,{cableApp:e.props.cableApp}):Object(g.jsx)(y,{login:e.login})})},e}return a}(r.Component)}}]);
//# sourceMappingURL=3.c67a736c.chunk.js.map