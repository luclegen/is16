(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[4],{75:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return T}));var s=a(6),n=a(10),i=a(9),r=a(1),o=a(40),c=a.n(o),l=a(41),d=a(16),u=a(11),m=a(44),h=a.n(m),p=h.a.create({timeout:2e4,headers:{Accept:"application/json","Content-Type":"application/json"}});p.interceptors.response.use((function(e){return e}),function(){var e=Object(l.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.response?alert("object"===typeof t.response.data?(null===(a=t.response.data)||void 0===a?void 0:a.error)||Object.entries(t.response.data).map((function(e,t){return t+1+". "+e[1]})).join("\n"):t.response.data.trim()||t.response.statusText):console.error(t),e.abrupt("return",Promise.reject(t));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var v=p,b="".concat("https://xis16.herokuapp.com/","auth/"),j=new function e(){Object(s.a)(this,e),this.login=function(e){return v.post(b,e)},this.available=function(e){return v.get("".concat(b,"?email=").concat(e))}},g="".concat("https://xis16.herokuapp.com/","codes/"),f=new function e(){Object(s.a)(this,e),this.create=function(e){return v.post(g,e)}},x=h.a.create();x.interceptors.request.use(function(){var e=Object(l.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.headers={Authorization:"Bearer ".concat(u.a.getCookie("token")),Accept:"application/json","Content-Type":"application/json"},e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){return Promise.reject(e)})),x.interceptors.response.use((function(e){return e}),function(){var e=Object(l.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.response&&440===t.response.status&&window.confirm(t.response.data)?(u.a.logout(),"/"!==window.location.pathname&&window.open("/")):t.response?alert("object"===typeof t.response.data?(null===(a=t.response.data)||void 0===a?void 0:a.error)||Object.entries(t.response.data).map((function(e,t){return t+1+". "+e[1]})).join("\n"):t.response.data.trim()||t.response.statusText):console.error(t),e.abrupt("return",Promise.reject(t));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var O=x,y="".concat("https://xis16.herokuapp.com/","users/"),N=new function e(){Object(s.a)(this,e),this.create=function(e){return v.post(y,e)},this.list=function(e){return O.get("".concat(y,"?name=").concat(e))}},w=a(3),S=Object.freeze({FEMALE:"Female",MALE:"Male",OTHER:"Other"}),C={name:"",surname:"",email:"",password:"",confirm:"",day:(new Date).getDate(),month:(new Date).getMonth()+1,year:(new Date).getFullYear(),sex:"",code:"",available:!0,sent:!1,submitted:!1},k=function(e){Object(n.a)(a,e);var t=Object(i.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).setName=function(e){return n.setState({name:e.target.value})},n.setSurname=function(e){return n.setState({surname:e.target.value})},n.setEmail=function(e){return n.setState({email:e.target.value})},n.setPassword=function(e){return n.setState({password:e.target.value})},n.setConfirm=function(e){return n.setState({confirm:e.target.value})},n.setDay=function(e){return n.setState({day:parseInt(e.target.value)})},n.setMonth=function(e){return n.setState({month:parseInt(e.target.value)})},n.setYear=function(e){return n.setState({year:parseInt(e.target.value)})},n.setSex=function(e){return n.setState({sex:e.target.value})},n.isCode=function(){return 6==="0".repeat(6).split("").map((function(e,t){return document.querySelectorAll(".input-digit")[t].value})).filter((function(e){return u.a.isDigit(e)})).length},n.setCode=function(){return n.setState({code:n.isCode()?Array.from(document.querySelectorAll(".input-digit")).map((function(e){return e.value})).join(""):""})},n.getInput=function(){return document.querySelectorAll(".input-digit")},n.getIndex=function(e){return Array.from(document.querySelector(".row-code").children).findIndex((function(t){return t===e}))},n.checkSex=function(e){var t=e.target.className.split(" ")[0];if("form-check-female"===t||"form-check-male"===t||"form-check-other"===t){var a=Array.from(e.target.children)[1];a.checked=!0,n.setState({sex:a.value})}},n.enterName=function(e){return e.target.setCustomValidity(e.target.value?u.a.isName(e.target.value)?"":"Invalid first name.":"This field is required.")},n.enterSurname=function(e){return e.target.setCustomValidity(e.target.value?u.a.isSurname(e.target.value)?"":"Invalid last name.":"This field is required.")},n.enterEmail=function(){var e=Object(l.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.available(t.target.value);case 2:e.t0=e.sent.status,a=200===e.t0,n.setState({available:a}),t.target.setCustomValidity(t.target.value?u.a.isEmail(t.target.value)?a?"":"Email is duplicate.":"Invalid email.":"This field is required.");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.enterPassword=function(e){var t=u.a.checkPassword(e.target.value);e.target.setCustomValidity(e.target.value?t.isStrong?"":"Please choose a stronger password. Try a mix of letters, numbers, and symbols (minimum is 8 characters)!":"This field is required."),document.querySelector("meter").value=t.level,n.setState({strength:t.strength})},n.enterConfirm=function(e){return e.target.setCustomValidity(e.target.value?e.target.value===n.state.password?"":"The passwords do not match.":"This field is required.")},n.enterDigit=function(e){var t=[n.getIndex(e.target.closest(".col-md")),n.getInput()],a=t[0],s=t[1];if(e.target.value.length>1)return s[a].value=e.target.value[0];a<5&&u.a.isDigit(s[a].value)&&1===s[a].value.length&&s[a+1].focus(),n.setCode()},n.clearDigit=function(e){var t=[n.getIndex(e.target.closest(".col-md")),n.getInput()],a=t[0],s=t[1];8===e.keyCode&&a>0&&""===e.target.value&&s[a-1].select(),n.isCode()||n.setState({code:Array.from(document.querySelectorAll(".input-digit")).map((function(e){return e.value})).join("")}),n.setCode()},n.pasteDigit=function(e){var t=[n.getIndex(e.target.closest(".col-md")),n.getInput()],a=t[0],s=t[1],i=(e.clipboardData||window.clipboardData).getData("text"),r=i.length>6-a?6-a:i.length,o=r+a>5?5:r+a;setTimeout((function(){s[a].value=u.a.isDigit(i[0])?i[0]:null,u.a.isDigits(i)&&s[o].focus()}));for(var c=a,l=0;l<r;c++,l++)s[c].value=u.a.isDigit(i[l])?i[l]:null;n.setCode()},n.chooseDob=function(e){document.querySelector("#dayRegister").setCustomValidity(u.a.isDate("yearRegister"===e.target.id?e.target.value:n.state.year,"monthRegister"===e.target.id?e.target.value:n.state.month,"dayRegister"===e.target.id?e.target.value:n.state.day)?"":"Invalid date of birth."),document.querySelector("#yearRegister").setCustomValidity((new Date).getFullYear()-parseInt("yearRegister"===e.target.id?e.target.value:n.state.year)>=5?"":"You must be 5 years or older")},n.chooseSex=function(){return document.querySelector("#femaleRegister").setCustomValidity(n.state.sex?"":"Please select one of these options")},n.getIsValidDob=function(){return(n.state.submitted||n.state.day!==(new Date).getDate()||n.state.month!==(new Date).getMonth()+1||n.state.year!==(new Date).getFullYear())&&(u.a.isDate(n.state.year,n.state.month,n.state.day)&&u.a.isOldEnough(n.state.year)?"is-valid":"is-invalid")},n.send=function(){return u.a.isEmail(n.state.email)&&f.create({email:n.state.email}).then((function(e){return window.open(e.data)&&n.setState({sent:!0})}))},n.submit=function(e){e.preventDefault(),n.setState({submitted:!0}),n.state.password===n.state.confirm&&n.state.name&&n.state.surname&&n.state.email&&n.state.password&&n.state.confirm&&n.state.day&&n.state.month&&n.state.year&&n.state.code&&(document.querySelector("#femaleRegister").setCustomValidity(n.state.sex?"":"Please select one of these options"),document.querySelector("#yearRegister").setCustomValidity(u.a.isOldEnough(n.state.year)?"":"You must be 5 years or older"),N.create(n.state).then((function(e){alert(e.data),document.querySelector(".form-register").reset(),document.querySelector("meter").value=0,n.setState(C)})).catch((function(e){var t;return 410===(null===(t=e.response)||void 0===t?void 0:t.status)&&Array.from(document.querySelectorAll(".input-digit")).map((function(e){return e.value=""}))})))},n.componentDidUpdate=function(){return window.onbeforeunload=function(){return!!(n.state.name||n.state.surname||n.state.email||n.state.password||n.state.day||n.state.month||n.state.year||n.state.sex||n.state.code)||void 0}},n.render=function(){return Object(w.jsx)("section",{className:"section-register",children:Object(w.jsxs)("form",{className:"form-register",onSubmit:n.submit,children:[Object(w.jsx)("div",{className:"row",children:Object(w.jsx)("div",{className:"col-dm d-flex justify-content-end",children:Object(w.jsx)("button",{className:"btn-close",type:"reset",onClick:n.props.close})})}),Object(w.jsx)("h1",{className:"h1-register",children:"Sign Up"}),Object(w.jsxs)("div",{className:"row-name",children:[Object(w.jsx)("div",{className:"col-md",children:Object(w.jsxs)("div",{className:"form-floating-name",children:[Object(w.jsx)("input",{className:"form-control ".concat(n.state.name&&(u.a.isName(n.state.name)?"is-valid":"is-invalid")),id:"nameRegister",type:"text",placeholder:"Name",value:n.state.name,pattern:u.a.namePattern,onInput:n.enterName,onInvalid:n.enterName,onChange:n.setName,required:!0}),Object(w.jsx)("label",{htmlFor:"nameRegister",children:"Name"})]})}),Object(w.jsx)("div",{className:"col-md",children:Object(w.jsxs)("div",{className:"form-floating-surname",children:[Object(w.jsx)("input",{className:"form-control ".concat(n.state.surname&&(u.a.isSurname(n.state.surname)?"is-valid":"is-invalid")),id:"surnameRegister",type:"text",placeholder:"Surname",pattern:u.a.surnamePattern,onInput:n.enterSurname,onInvalid:n.enterSurname,onChange:n.setSurname,required:!0}),Object(w.jsx)("label",{htmlFor:"surnameRegister",children:"Surname"})]})})]}),Object(w.jsxs)("div",{className:"form-floating-email",children:[Object(w.jsx)("input",{className:"form-control ".concat(n.state.email&&(u.a.isEmail(n.state.email)&&n.state.available?"is-valid":"is-invalid")),id:"addressRegister",type:"email",placeholder:"Email",pattern:u.a.emailPattern,onInput:n.enterEmail,onInvalid:n.enterEmail,onChange:n.setEmail,required:!0}),Object(w.jsx)("label",{htmlFor:"addressRegister",children:"Email"})]}),Object(w.jsxs)("div",{className:"row-password",children:[Object(w.jsx)("div",{className:"col-md",children:Object(w.jsxs)("div",{className:"form-floating-password",children:[Object(w.jsx)("input",{className:"form-control ".concat(n.state.password&&(u.a.checkPassword(n.state.password).isStrong?"is-valid":"is-invalid")),id:"passwordRegister",type:"password",placeholder:"Password",minLength:"8",onInput:n.enterPassword,onChange:n.setPassword,required:!0}),Object(w.jsx)("label",{htmlFor:"passwordRegister",children:"Password"})]})}),Object(w.jsx)("div",{className:"col-md",children:Object(w.jsxs)("div",{className:"form-floating-confirm",children:[Object(w.jsx)("input",{className:"form-control ".concat(n.state.confirm&&(n.state.confirm===n.state.password?"is-valid":"is-invalid")),id:"confirmRegister",type:"password",placeholder:"Confirm",onInput:n.enterConfirm,onInvalid:n.enterConfirm,onChange:n.setConfirm,required:!0}),Object(w.jsx)("label",{htmlFor:"confirmRegister",children:"Confirm"})]})})]}),Object(w.jsx)("meter",{id:"passwordStrengthRegister",title:"Use 8 or more characters with a mix of letters, numbers, and symbols",max:"4",value:"0"}),Object(w.jsx)("div",{className:"input-group-password-strength",children:n.state.strength&&Object(w.jsx)("label",{className:"password-strength",htmlFor:"passwordStrengthRegister",children:u.a.checkPassword(n.state.password).strength})}),Object(w.jsx)("label",{className:"label-group ".concat(n.getIsValidDob()),htmlFor:"dobRegister",children:"Date of birth"}),Object(w.jsxs)("div",{className:"row-dob",id:"dobRegister",children:[Object(w.jsx)("div",{className:"col-md",children:Object(w.jsxs)("div",{className:"form-floating-day",children:[Object(w.jsx)("select",{className:"form-select-day ".concat(n.getIsValidDob()),id:"dayRegister",placeholder:"Day",value:n.state.day,onInput:n.chooseDob,onChange:n.setDay,required:!0,children:"0".repeat(31).split("").map((function(e,t){return Object(w.jsx)("option",{value:t+1,children:t+1},t)}))}),Object(w.jsx)("label",{htmlFor:"dayRegister",children:"Day"})]})}),Object(w.jsx)("div",{className:"col-md",children:Object(w.jsxs)("div",{className:"form-floating-month",children:[Object(w.jsx)("select",{className:"form-select-month ".concat(n.getIsValidDob()),id:"monthRegister",placeholder:"Month",value:n.state.month,onInput:n.chooseDob,onChange:n.setMonth,required:!0,children:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((function(e,t){return Object(w.jsx)("option",{value:t+1,children:e},t)}))}),Object(w.jsx)("label",{htmlFor:"monthRegister",children:"Month"})]})}),Object(w.jsx)("div",{className:"col-md",children:Object(w.jsxs)("div",{className:"form-floating-year",children:[Object(w.jsx)("select",{className:"form-select-year ".concat(n.getIsValidDob()),id:"yearRegister",placeholder:"Year",value:n.state.year,"aria-describedby":"validationDob",onInput:n.chooseDob,onChange:n.setYear,required:!0,children:"0".repeat(200).split("").map((function(e,t){return Object(w.jsx)("option",{value:(new Date).getFullYear()-t,children:(new Date).getFullYear()-t},t)}))}),Object(w.jsx)("label",{htmlFor:"yearRegister",children:"Year"})]})})]}),Object(w.jsx)("label",{className:"label-group ".concat(n.state.sex?"is-valid":n.state.submitted&&!n.state.sex&&"is-invalid"),htmlFor:"genderRegister",children:"Gender"}),Object(w.jsxs)("div",{className:"row-gender",id:"genderRegister",children:[Object(w.jsx)("div",{className:"col-md",children:Object(w.jsxs)("div",{className:"form-check-female ".concat(n.state.sex?"is-valid":n.state.submitted&&!n.state.sex&&"is-invalid"),onClick:n.checkSex,children:[Object(w.jsx)("label",{className:"label-female",htmlFor:"femaleRegister",children:"Female"}),Object(w.jsx)("input",{className:"input-female",id:"femaleRegister",type:"radio",name:"sex",value:S.FEMALE,checked:n.state.sex===S.FEMALE,onInput:n.chooseSex,onChange:n.setSex})]})}),Object(w.jsx)("div",{className:"col-md",children:Object(w.jsxs)("div",{className:"form-check-male ".concat(n.state.sex?"is-valid":n.state.submitted&&!n.state.sex&&"is-invalid"),onClick:n.checkSex,children:[Object(w.jsx)("label",{className:"label-male",htmlFor:"maleRegister",children:"Male"}),Object(w.jsx)("input",{className:"input-male",id:"maleRegister",type:"radio",name:"sex",value:S.MALE,checked:n.state.sex===S.MALE,onInput:n.chooseSex,onChange:n.setSex})]})}),Object(w.jsx)("div",{className:"col-md",children:Object(w.jsxs)("div",{className:"form-check-other ".concat(n.state.sex?"is-valid":n.state.submitted&&!n.state.sex&&"is-invalid"),onClick:n.checkSex,children:[Object(w.jsx)("label",{className:"label-other",htmlFor:"otherRegister",children:"Other"}),Object(w.jsx)("input",{className:"input-other",id:"otherRegister",type:"radio",name:"sex",value:S.OTHER,checked:n.state.sex===S.OTHER,onInput:n.chooseSex,onChange:n.setSex})]})})]}),Object(w.jsx)("label",{className:"label-group",htmlFor:"genderRegister",children:"Code"}),Object(w.jsx)("div",{className:"row-code",id:"codeRegister",children:"0".repeat(6).split("").map((function(e,t){return Object(w.jsx)("div",{className:"col-md",children:Object(w.jsx)("input",{className:"input-digit",type:"number",maxLength:"1",onClick:function(e){return e.target.select()},onInput:n.enterDigit,onDrop:n.enterDigit,onKeyUp:n.clearDigit,onKeyDown:n.clearDigit,onPaste:n.pasteDigit,required:!0})},t)}))}),Object(w.jsx)("div",{className:"row",children:Object(w.jsx)("div",{className:"col-dm d-flex justify-content-center",children:n.state.code?Object(w.jsx)("button",{className:"btn-sign-up",type:"submit",children:"Sign Up"}):Object(w.jsxs)("button",{className:"btn-get-code",type:"button",onClick:n.send,children:[n.state.sent?"Resend":"Send"," Code"]})})})]})})},n.setName=n.setName.bind(Object(d.a)(n)),n.setSurname=n.setSurname.bind(Object(d.a)(n)),n.setEmail=n.setEmail.bind(Object(d.a)(n)),n.setPassword=n.setPassword.bind(Object(d.a)(n)),n.setConfirm=n.setConfirm.bind(Object(d.a)(n)),n.setDay=n.setDay.bind(Object(d.a)(n)),n.setMonth=n.setMonth.bind(Object(d.a)(n)),n.setYear=n.setYear.bind(Object(d.a)(n)),n.setSex=n.setSex.bind(Object(d.a)(n)),n.state=C,n}return a}(r.Component),I={email:"",password:"",remembered:!1,available:!1,visible:!1,opened:!1},D=function(e){Object(n.a)(a,e);var t=Object(i.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).setEmail=function(e){return n.setState({email:e.target.value})},n.setPassword=function(e){return n.setState({password:e.target.value})},n.setRemembered=function(e){return n.setState({remembered:e.target.checked})},n.enterEmail=function(){var e=Object(l.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.target.value){e.next=8;break}return e.next=3,j.available(t.target.value);case 3:e.t0=e.sent.status,a=200===e.t0,t.target.setCustomValidity(u.a.isEmail(t.target.value)?a?"Email not registered":"":"Invalid email!"),n.setState({available:a,visible:!1,password:""}),setTimeout((function(){document.querySelector(".input-group-password")&&(document.querySelector(".input-group-password").style.height=0),document.querySelector(".input-email").style.width="260px"}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.open=function(){return n.setState({opened:!0})},n.close=function(){return n.setState({opened:!1})},n.submit=function(e){e.preventDefault(),n.state.email&&(n.setState({visible:!0}),setTimeout(Object(l.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.querySelector(".input-group-password").style.height="39px",document.querySelector(".input-email").style.width="315px",document.querySelector(".input-password").focus(),n.state.password&&j.login(n.state).then((function(e){return u.a.setCookie(e.data)&&(n.state=I)&&setTimeout((function(){return window.location.reload()}))}));case 4:case"end":return e.stop()}}),e)})))))},n.componentDidUpdate=function(){return window.onbeforeunload=function(){return!(!n.state.email&&!n.password)||void 0}},n.render=function(){return Object(w.jsxs)("section",{className:"section-only",children:[Object(w.jsxs)("form",{className:"form-only",onSubmit:n.submit,children:[Object(w.jsx)("img",{className:"logo-img",src:"/logo.svg",alt:"IS16 logo"}),Object(w.jsxs)("h1",{className:"h1-only",children:["Sign in to ","IS16"]}),Object(w.jsxs)("div",{className:"input-group-email ".concat(n.state.visible?"rounded-top":"rounded"),children:[Object(w.jsx)("input",{className:"input-email",type:"email",name:"email",placeholder:"Email",value:n.state.email,pattern:u.a.emailPattern,onInput:n.enterEmail,onInvalid:n.enterEmail,onChange:n.setEmail,title:"Please fill out this field.",required:!0}),!n.state.visible&&Object(w.jsx)("button",{className:"btn-input",type:"submit",disabled:!n.state.email,hidden:!0,children:Object(w.jsx)("i",{className:"material-icons",children:"input"})})]}),Object(w.jsx)("div",{className:"input-group-container",children:n.state.visible&&n.state.email&&Object(w.jsxs)("div",{className:"input-group-password",children:[Object(w.jsx)("input",{className:"input-password",type:"password",name:"password",placeholder:"Password",value:n.state.password,onChange:n.setPassword,required:!0}),Object(w.jsx)("button",{className:"btn-input",type:"submit",disabled:!n.state.password,children:Object(w.jsx)("i",{className:"material-icons",children:"input"})})]})}),Object(w.jsxs)("a",{className:"link-find-account",href:"/find-account",target:"_blank",rel:"noopener noreferrer",children:["Forgotten password? ",Object(w.jsx)("i",{className:"material-icons",children:"launch"})]}),Object(w.jsx)("button",{className:"btn-create-account",type:"button",onClick:n.open,children:"Create New Account"})]}),n.state.opened&&Object(w.jsx)(k,{close:n.close})]})},n.setEmail=n.setEmail.bind(Object(d.a)(n)),n.setPassword=n.setPassword.bind(Object(d.a)(n)),n.setRemembered=n.setRemembered.bind(Object(d.a)(n)),n.state=I,n}return a}(r.Component),_=a(72),R=a(8),q=a(17),$="".concat("https://xis16.herokuapp.com/","messages/"),A=new function e(){Object(s.a)(this,e),this.create=function(e){return O.post($,e)},this.delete=function(e){return O.delete("".concat($).concat(e))},this.list=function(e){return O.get("".concat($,"?name=").concat(e))}},E="".concat("https://xis16.herokuapp.com/","chats/"),M=new function e(){Object(s.a)(this,e),this.read=function(e){return O.get("".concat(E).concat(e))},this.update=function(e){return O.put("".concat(E).concat(null===e||void 0===e?void 0:e.id),e)},this.list=function(){return O.get(E)}},P=function(e){Object(n.a)(a,e);var t=Object(i.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).setMessage=function(e){return n.setState({message:e.target.value})},n.setName=function(e){return n.setState({name:e.target.value})},n.setChats=function(e){return M.list().then((function(t){var a,s;return M.read(e||(null===(a=n.state.chat)||void 0===a||null===(s=a._id)||void 0===s?void 0:s.$oid)||null).then((function(e){return setTimeout((function(){return n.scroll()}))&&n.setState({new:!e.data,photo:n.state.photo?e.data.photo:"",title:n.state.title?e.data.title:"",chat:e.data,chats:t.data})}))}))},n.setMessages=function(e){return M.read(e).then((function(e){return n.setState({messages:e.data.messages})}))},n.setTitle=function(e){return n.setState({title:e.target.value})},n.setPhoto=function(e){return n.setState({photo:e.target.value})},n.choose=function(e){var t,a,s;return n.state.name||(null===(t=n.state.users)||void 0===t?void 0:t.length)||n.state.photo||n.state.title?window.confirm("Discard?\nChanges you made may not be saved.")&&n.setChats(null===(a=e.target.closest("button"))||void 0===a?void 0:a.id)&&(n.reset()||n.setState({new:!1})):n.setChats(null===(s=e.target.closest("button"))||void 0===s?void 0:s.id)&&(n.reset()||n.setState({new:!1}))},n.create=function(){var e;return n.state.name||(null===(e=n.state.users)||void 0===e?void 0:e.length)||n.state.photo||n.state.title?window.confirm("Discard?\nChanges you made may not be saved.")&&(n.reset()||n.setState({chat:null,new:!0})):n.reset()||n.setState({chat:null,new:!0})},n.edit=function(){var e,t;return setTimeout((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.querySelector(".box-title").clientWidth+26+"px";return setTimeout((function(){return document.querySelector(".input-title").style.setProperty("width",e,"important")}))&&n.setState({edit:!n.state.edit})}))&&n.setState({photo:null===(e=n.state.chat)||void 0===e?void 0:e.photo,title:null===(t=n.state.chat)||void 0===t?void 0:t.title})},n.save=function(){var e,t;return n.state.edit&&M.update({id:null===(e=n.state.chat)||void 0===e||null===(t=e._id)||void 0===t?void 0:t.$oid,photo:n.state.photo,title:n.state.title}).then((function(){return n.setChats()&&n.setState({edit:!1,photo:"",title:""})}))},n.enter=function(e){var t;return 8===e.keyCode&&!n.state.prename&&!n.state.name&&(null===(t=n.state.users)||void 0===t?void 0:t.pop())&&n.setState({users:n.state.users})||n.setState({prename:n.state.name})||setTimeout((function(){return N.list(e.target.value).then((function(t){return n.setState({name:e.target.value,foundUsers:t.data})}))&&setTimeout((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.querySelector(".list-group-users"),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.querySelector(".input-group-user"),a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.a.getOffset(document.querySelector(".input-user")),s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:u.a.getOffset(document.querySelector(".label-user"));return e&&t&&(e.style.setProperty("display","block","important")||(e.style.top="0px")&&(e.style.left="0px")&&(e.style.top=a.top-s.top+t.offsetHeight+6+"px")&&(e.style.left=a.left-s.left+"px"))}))&&N.list(e.target.value).then((function(t){return n.setState({name:e.target.value,foundUsers:t.data})}))}))},n.add=function(e){var t,a;return setTimeout((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.querySelector(".input-user");return(e.value="")||(null===e||void 0===e?void 0:e.focus())}))&&!(null===(t=n.state.users)||void 0===t?void 0:t.find((function(t){return t.id===e.target.id})))&&(null===(a=n.state.users)||void 0===a?void 0:a.push({id:e.target.id,name:e.target.name}))&&n.setState({users:n.state.users,prename:"",name:"",foundUsers:[]})},n.remove=function(e){var t,a;return e.target.closest(".tag")&&(null===(t=n.state.users)||void 0===t?void 0:t.splice(null===(a=n.state.users)||void 0===a?void 0:a.findIndex((function(t){return t.id===e.target.closest(".tag").id})),1))&&n.setState({users:n.state.users})},n.delete=function(e){var t,a;return window.confirm("Do you sure to "+("true"===(null===(t=e.target.closest(".container-message"))||void 0===t?void 0:t.getAttribute("unsent"))?"delete":"unsent")+" the message?")&&A.delete(null===(a=e.target.closest(".container-message"))||void 0===a?void 0:a.id).then((function(){return n.setChats()}))},n.send=function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===(t=e.target)||void 0===t?void 0:t.closest(".list-group-item");return setTimeout((function(){var e;return null===(e=document.querySelector(".input-user"))||void 0===e?void 0:e.focus()}))&&n.setState({users:[{id:null===a||void 0===a?void 0:a.id,name:null===a||void 0===a?void 0:a.getAttribute("name")}],new:!0})},n.make=function(e){var t,a,s,i,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===(t=e.target)||void 0===t?void 0:t.closest(".list-group-item");return window.confirm("Make admin?\n".concat(null===o||void 0===o?void 0:o.getAttribute("name")," can manage in ").concat(null===(a=n.state.chat)||void 0===a?void 0:a.title,"."))&&M.update({id:null===(s=n.state.chat)||void 0===s||null===(i=s._id)||void 0===i?void 0:i.$oid,admins:[].concat(Object(_.a)(null===(r=n.state.chat)||void 0===r?void 0:r.members.filter((function(e){return["Creator","Admin"].includes(e.role)})).map((function(e){var t;return null===(t=e._id)||void 0===t?void 0:t.$oid}))),[null===o||void 0===o?void 0:o.id])}).then((function(){return n.setChats()}))},n.removeAdmin=function(e){var t,a,s,i,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===(t=e.target)||void 0===t?void 0:t.closest(".list-group-item");return window.confirm("Remove as Admin?\n".concat(null===o||void 0===o?void 0:o.getAttribute("name")," cannot manage in ").concat(null===(a=n.state.chat)||void 0===a?void 0:a.title,"."))&&M.update({id:null===(s=n.state.chat)||void 0===s||null===(i=s._id)||void 0===i?void 0:i.$oid,admins:null===(r=n.state.chat)||void 0===r?void 0:r.members.filter((function(e){return["Creator","Admin"].includes(e.role)})).map((function(e){var t;return null===(t=e._id)||void 0===t?void 0:t.$oid})).filter((function(e){return e!==(null===o||void 0===o?void 0:o.id)}))}).then((function(){return n.setChats()}))},n.removeMember=function(e){var t,a,s,i,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===(t=e.target)||void 0===t?void 0:t.closest(".list-group-item");return window.confirm("Remove?\n".concat(null===o||void 0===o?void 0:o.getAttribute("name")," was removed from ").concat(null===(a=n.state.chat)||void 0===a?void 0:a.title,"."))&&M.update({id:null===(s=n.state.chat)||void 0===s||null===(i=s._id)||void 0===i?void 0:i.$oid,users:null===(r=n.state.chat)||void 0===r?void 0:r.members.map((function(e){var t;return null===(t=e._id)||void 0===t?void 0:t.$oid})).filter((function(e){return e!==(null===o||void 0===o?void 0:o.id)}))}).then((function(){return n.setChats()}))},n.addMember=function(e){var t,a,s,i,r;return window.confirm("Add?\n".concat(null===(t=n.state.users)||void 0===t?void 0:t.map((function(e){return e.name})).join(", ")," was added to ").concat(null===(a=n.state.chat)||void 0===a?void 0:a.title,"."))&&M.update({id:null===(s=n.state.chat)||void 0===s||null===(i=s._id)||void 0===i?void 0:i.$oid,users:null===(r=n.state.chat)||void 0===r?void 0:r.members.map((function(e){var t;return null===(t=e._id)||void 0===t?void 0:t.$oid})).concat(n.state.users.map((function(e){return e.id})))}).then((function(){return n.setChats()&&n.setState({name:"",users:[]})}))},n.admin=function(){var e;return null===(e=n.state.chat)||void 0===e?void 0:e.members.filter((function(e){return["Creator","Admin"].includes(e.role)})).map((function(e){var t;return null===(t=e._id)||void 0===t?void 0:t.$oid})).includes(u.a.getId())},n.scroll=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.querySelector(".chat-body");return e&&(e.scrollTop=e.scrollHeight)},n.toggle=function(){return n.setState({info:!n.state.info})},n.toggleDropdown=function(e){var t;return n.setState({open:!n.state.open,id:null===(t=e.target.closest(".list-group-item"))||void 0===t?void 0:t.id})},n.reset=function(){return n.setState({edit:!1,photo:"",title:"",name:"",users:[]})},n.submit=function(e){var t,a,s;return e.preventDefault()||n.state.message&&A.create(n.state.new?{users:null===(t=n.state.users)||void 0===t?void 0:t.map((function(e){return e.id})),body:n.state.message}:{id:null===(a=n.state.chat)||void 0===a||null===(s=a._id)||void 0===s?void 0:s.$oid,body:n.state.message}).then((function(t){return n.setChats(t.data)&&e.target.reset()&&n.reset()}))},n.componentDidMount=function(){return n.setChats()&&setTimeout((function(){var e;return null===(e=document.querySelector(".input-".concat(n.state.new?"user":"message")))||void 0===e?void 0:e.focus()}),500)},n.componentDidUpdate=function(){return setTimeout((function(){return!n.state.new&&n.setChats()}),1e4)||(window.onbeforeunload=function(){var e;return!!(n.state.message||n.state.name||(null===(e=n.state.users)||void 0===e?void 0:e.length)||n.state.title||n.state.photo)||void 0})},n.render=function(){var e,t,a,s,i,r,o,c,l,d,m,h,p,v,b,j,g,f,x,O,y,N;return Object(w.jsxs)("section",{className:"section-chats",children:[Object(w.jsxs)("div",{className:"col-chats",children:[Object(w.jsxs)("div",{className:"chats-bar",children:[Object(w.jsx)("h2",{className:"h2-chat",children:"Chats"}),Object(w.jsx)("button",{className:"btn-write",type:"button",onClick:n.create,children:Object(w.jsx)("i",{className:"material-icons",children:"create"})})]}),Object(w.jsx)("div",{className:"search-bar",onMouseEnter:n.coloring,onMouseLeave:n.coloring,children:Object(w.jsxs)("form",{className:"form-search",children:[Object(w.jsx)("button",{className:"btn-search",type:n.state.width>800||n.state.opened&&n.state.keyword?"submit":"button",disabled:n.state.width>800&&!n.state.keyword,onClick:n.open,children:Object(w.jsx)("i",{className:"material-icons",children:"search"})}),Object(w.jsx)("input",{className:"input-search",type:"search",placeholder:"Search for anything",onSelect:n.coloring,onBlur:n.coloring,onInput:n.setKeyword})]})}),Object(w.jsx)("div",{className:"list-group",children:(null===(e=n.state.chats)||void 0===e?void 0:e.length)>0&&n.state.chats.map((function(e,t){var a,s,i,r;return Object(w.jsxs)("button",{className:"list-group-item list-group-item-action ".concat((null===(a=e._id)||void 0===a?void 0:a.$oid)===(null===(s=n.state.chat)||void 0===s||null===(i=s._id)||void 0===i?void 0:i.$oid)&&"active"),id:null===(r=e._id)||void 0===r?void 0:r.$oid,type:"button",onClick:n.choose,children:[Object(w.jsx)(q.a,{avatar:e.photo,name:e.title,width:"60px",height:"60px",fontSize:"45px"}),Object(w.jsxs)("div",{className:"user-info",children:[Object(w.jsx)("p",{className:"fs-5",children:e.title}),Object(w.jsx)("p",{className:"text-truncate",children:e.message})]})]},t)}))})]}),Object(w.jsxs)("div",{className:"col-chat col-md-".concat(n.state.new||!n.state.info?"9":"6"),children:[n.state.new?Object(w.jsx)("div",{className:"chat-header",children:Object(w.jsxs)("div",{className:"input-group-user",children:[Object(w.jsx)("label",{className:"label-user",htmlFor:"userInput",children:"To: \xa0"}),n.state.name&&Object(w.jsx)("div",{className:"list-group-users",children:n.state.foundUsers.map((function(e,t){var a;return Object(w.jsx)("button",{type:"button",className:"list-group-item list-group-item-action",id:null===(a=e._id)||void 0===a?void 0:a.$oid,name:e.name,onClick:n.add,children:e.name},t)}))}),null===(t=n.state.users)||void 0===t?void 0:t.map((function(e,t){return Object(w.jsxs)("span",{type:"button",className:"tag",id:e.id,children:[e.name,Object(w.jsx)("button",{className:"btn-tag-close",type:"button",onClick:n.remove,children:Object(w.jsx)("i",{className:"material-icons",children:"close"})})]},t)})),Object(w.jsx)("input",{type:"text",className:"input-user",id:"userInput",onInput:n.enter,onKeyUp:n.enter,onChange:n.setName})]})}):Object(w.jsxs)("div",{className:"chat-header",children:[n.state.chat&&Object(w.jsx)(q.a,{avatar:null===(a=n.state.chat)||void 0===a?void 0:a.photo,name:null===(s=n.state.chat)||void 0===s?void 0:s.title,width:"44px",height:"44px",fontSize:"30px"}),n.state.chat&&Object(w.jsx)("strong",{className:"chat-name",children:null===(i=n.state.chat)||void 0===i?void 0:i.title}),n.state.chat&&Object(w.jsx)("button",{className:"btn-chat-info ".concat(n.state.info&&"border-primary"),type:"button",onClick:n.toggle,children:Object(w.jsx)("i",{className:"material-icons",children:"info"})})]}),Object(w.jsx)("div",{className:"chat-body",children:(null===(r=n.state.chat)||void 0===r||null===(o=r.messages)||void 0===o?void 0:o.length)>0&&(null===(c=n.state.chat)||void 0===c?void 0:c.messages.map((function(e,t,a){var s;return Object(w.jsx)("div",{className:"container-message",id:null===(s=e._id)||void 0===s?void 0:s.$oid,unsent:e.unsent.toString(),children:Object(w.jsxs)("div",{className:"row",children:[Object(w.jsxs)("div",{className:"col-".concat(e._uid.$oid!==u.a.getId()?"8":"4"," col-message justify-content-").concat(e._uid.$oid!==u.a.getId()?"start":"end"),children:[e._uid.$oid!==u.a.getId()&&(0===t||a.length>1&&t>0&&a[t]._uid.$oid!==a[t-1]._uid.$oid)?Object(w.jsx)(q.a,{avatar:e.avatar,name:e.name,width:"40px",height:"40px",fontSize:"30px"}):Object(w.jsx)("div",{style:{width:"40px",height:"40px"}}),e._uid.$oid!==u.a.getId()&&Object(w.jsx)("div",{className:"box-receiver-message ".concat(t>0&&a[t]._uid.$oid===a[t-1]._uid.$oid&&"tl"," ").concat(t<a.length-1&&a[t]._uid.$oid===a[t+1]._uid.$oid&&"bl"," ms-2"),children:e.body})]}),Object(w.jsxs)("div",{className:"col-".concat(e._uid.$oid===u.a.getId()?"8":"4"," col-message justify-content-").concat(e._uid.$oid!==u.a.getId()?"start":"end"),children:[e._uid.$oid===u.a.getId()&&Object(w.jsx)("button",{className:"btn-delete",type:"button",onClick:n.delete,children:Object(w.jsx)("i",{className:"material-icons",children:"delete"})}),e._uid.$oid===u.a.getId()&&Object(w.jsx)("div",{className:"box-sender-message ".concat(t>0&&a[t]._uid.$oid===a[t-1]._uid.$oid&&"tr"," ").concat(t<a.length-1&&a[t]._uid.$oid===a[t+1]._uid.$oid&&"br"),children:e.body})]})]})},t)})))}),((null===(l=n.state.users)||void 0===l?void 0:l.length)>0||n.state.chat)&&Object(w.jsx)("div",{className:"chat-footer",children:Object(w.jsx)("form",{className:"form-message",onSubmit:n.submit,children:Object(w.jsxs)("div",{className:"input-group flex-nowrap",children:[Object(w.jsx)("input",{className:"input-message",type:"text",placeholder:"Aa",onChange:n.setMessage}),Object(w.jsx)("button",{className:"btn-send",type:"submit",disabled:!n.state.message,children:Object(w.jsx)("i",{className:"material-icons",children:"send"})})]})})})]}),Object(w.jsxs)("div",{className:"col-info ".concat(n.state.new||!n.state.info?"d-none":"d-flex"," col-md-").concat(n.state.new||!n.state.info?"0":"3"),children:[Object(w.jsx)(q.a,{avatar:n.state.photo||(null===(d=n.state.chat)||void 0===d?void 0:d.photo),name:null===(m=n.state.chat)||void 0===m?void 0:m.title,width:"80px",height:"80px",fontSize:"60px"}),Object(w.jsxs)("form",{className:"form-only",onSubmit:function(e){return e.preventDefault()||n.state.edit?n.save(e):n.edit(e)},children:[n.state.edit?Object(w.jsx)("input",{className:"input-title",value:n.state.title,type:"text",name:"Title input",onChange:n.setTitle}):Object(w.jsx)("div",{className:"box-title",children:Object(w.jsx)("strong",{children:(null===(h=n.state.chat)||void 0===h?void 0:h.group)?null===(p=n.state.chat)||void 0===p?void 0:p.title:Object(w.jsx)("a",{href:"/"+(null===(v=n.state.chat)||void 0===v||null===(b=v.members)||void 0===b||null===(j=b.find((function(e){var t;return u.a.getId()!==(null===(t=e._id)||void 0===t?void 0:t.$oid)})))||void 0===j||null===(g=j._id)||void 0===g?void 0:g.$oid),target:"_blank",rel:"noopener noreferrer",children:null===(f=n.state.chat)||void 0===f?void 0:f.title})})}),n.state.edit&&Object(w.jsx)("input",{className:"input-photo",value:n.state.photo,type:"color",name:"Photo input",onChange:n.setPhoto})]}),(null===(x=n.state.chat)||void 0===x?void 0:x.group)&&Object(w.jsxs)("details",{className:"details-customize",open:!0,children:[Object(w.jsx)("summary",{children:Object(w.jsx)("strong",{children:"Customize"})}),Object(w.jsx)("div",{className:"list-group",children:Object(w.jsxs)("button",{type:"button",className:"list-group-item list-group-item-action",onClick:n.state.edit?n.save:n.edit,children:[Object(w.jsx)("i",{className:"material-icons",children:"drive_file_rename_outline"}),Object(w.jsx)("p",{className:"list-group-item-name",children:n.state.edit?"Save":"Edit"})]})})]}),(null===(O=n.state.chat)||void 0===O?void 0:O.group)&&Object(w.jsxs)("details",{className:"details-members",open:!0,children:[Object(w.jsx)("summary",{children:Object(w.jsx)("strong",{children:"Members"})}),Object(w.jsxs)("ul",{className:"list-group",children:[null===(y=n.state.chat)||void 0===y?void 0:y.members.map((function(e,t){var a,s,i,r,o,c;return Object(w.jsxs)("li",{className:"list-group-item",id:null===(a=e._id)||void 0===a?void 0:a.$oid,name:e.name,children:[Object(w.jsx)(q.a,{avatar:e.avatar,name:e.name,width:"40px",height:"40px",fontSize:"30px"}),Object(w.jsx)("p",{className:"member-name",children:"".concat(e.name," ").concat(e.role&&"(".concat(e.role,")"))}),Object(w.jsxs)(R.a,{className:"dropdown-more",isOpen:n.state.id===(null===(s=e._id)||void 0===s?void 0:s.$oid)&&n.state.open,toggle:n.toggleDropdown,children:[Object(w.jsx)(R.d,{className:"dropdown-toggle-more",title:"More",children:Object(w.jsx)("i",{className:"material-icons",children:"more_horiz"})}),Object(w.jsxs)(R.c,{className:"dropdown-menu-more",children:[Object(w.jsxs)(R.b,{className:"dropdown-item-normal",children:[Object(w.jsx)("p",{className:"text-profile",onClick:n.send,children:"Message"}),Object(w.jsx)("i",{className:"material-icons",children:"chat"})]}),Object(w.jsxs)(R.b,{className:"dropdown-item-normal",tag:"a",href:"/"+(null===(i=e._id)||void 0===i?void 0:i.$oid),target:"_blank",rel:"noopener noreferrer",children:[Object(w.jsx)("p",{className:"text-help",children:"View profile"}),Object(w.jsx)("i",{className:"material-icons",children:"info"})]}),n.admin()&&"Creator"!==e.role&&Object(w.jsx)(R.b,{divider:!0}),"Creator"!==e.role&&n.admin()&&Object(w.jsxs)(R.b,{className:"dropdown-item-normal",onClick:e.role?n.removeAdmin:n.make,children:[Object(w.jsx)("p",{className:"text-help",children:"".concat(e.role?"Remove as A":"Make a","dmin")}),Object(w.jsx)("i",{className:"material-icons",children:"".concat(e.role?"remove":"add","_moderator")})]}),((null===(r=e._id)||void 0===r?void 0:r.$oid)===u.a.getId()||n.admin()&&"Creator"!==e.role)&&Object(w.jsxs)(R.b,{className:"dropdown-item-danger",onClick:n.removeMember,children:[Object(w.jsx)("p",{className:"text-logout",children:(null===(o=e._id)||void 0===o?void 0:o.$oid)===u.a.getId()?"Leave group":n.admin()&&"Remove"}),Object(w.jsx)("i",{className:"material-icons",children:(null===(c=e._id)||void 0===c?void 0:c.$oid)===u.a.getId()?"logout":n.admin()&&"person_remove"})]})]})]})]},t)})),Object(w.jsxs)("button",{type:"button",className:"list-group-item list-group-item-action",onClick:n.addMember,children:[Object(w.jsx)("i",{className:"add-member material-icons",children:"person_add"}),Object(w.jsx)("p",{className:"list-group-item-name",children:"Add"})]}),Object(w.jsx)("li",{className:"list-group-item",children:Object(w.jsxs)("div",{className:"input-group-user",children:[Object(w.jsx)("label",{className:"label-user",htmlFor:"userInput",children:"Add: \xa0"}),n.state.name&&Object(w.jsx)("div",{className:"list-group-users",children:n.state.foundUsers.map((function(e,t){var a;return Object(w.jsx)("button",{type:"button",className:"list-group-item list-group-item-action",id:null===(a=e._id)||void 0===a?void 0:a.$oid,name:e.name,onClick:n.add,children:e.name},t)}))}),null===(N=n.state.users)||void 0===N?void 0:N.map((function(e,t){return Object(w.jsxs)("span",{type:"button",className:"tag",id:e.id,children:[e.name,Object(w.jsx)("button",{className:"btn-tag-close",type:"button",onClick:n.remove,children:Object(w.jsx)("i",{className:"material-icons",children:"close"})})]},t)})),Object(w.jsx)("input",{type:"text",className:"input-user",id:"userInput",onInput:n.enter,onKeyUp:n.enter,onChange:n.setName})]})})]})]})]})]})},n.setMessage=n.setMessage.bind(Object(d.a)(n)),n.setName=n.setName.bind(Object(d.a)(n)),n.state={users:[],foundUsers:[],chats:[],chat:null,new:!1,edit:!1,info:!0,open:!1,id:"",name:"",prename:"",photo:"",title:"",message:""},n}return a}(r.Component),T=function(e){Object(n.a)(a,e);var t=Object(i.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).render=function(){return Object(w.jsx)("main",{children:u.a.loggedIn()?Object(w.jsx)(P,{}):Object(w.jsx)(D,{login:e.login})})},e}return a}(r.Component)}}]);
//# sourceMappingURL=4.5de56630.chunk.js.map